(()=>{"use strict";var e={576:(e,t,i)=>{i.d(t,{Z:()=>d});var s=i(81),a=i.n(s),h=i(645),n=i.n(h),r=i(667),o=i.n(r),m=new URL(i(910),i.b),g=n()(a()),l=o()(m);g.push([e.id,`@font-face {\n  font-family: 'MaShanZheng';\n\n  src: url(${l})  \n}\n\nbody{\n  font-family: 'MaShanZheng';\n\n}\n\n#canvas1{\n  /* background-color: skyblue; */\n\n  position: absolute;\n  top:50%;\n  left:50%;\n  transform: translate(-50%,-50%);\n  /* border: 5px solid black; */\n  max-width: 100%;\n  max-height: 100%;\n}\n\n#bgVideo{\n  position: absolute;\n  z-index: -1;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%,-50%);\n  height: 100%;\n}\n\n#bullet,\n#playerRunImage,\n#enemy,\n#enemy1,\n#lives,\n#collisionAnimation,\n#sound,\n#gunSound,\n#gunSound3 {\n  display: none;\n}`,""]);const d=g},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i="",s=void 0!==t[5];return t[4]&&(i+="@supports (".concat(t[4],") {")),t[2]&&(i+="@media ".concat(t[2]," {")),s&&(i+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),i+=e(t),s&&(i+="}"),t[2]&&(i+="}"),t[4]&&(i+="}"),i})).join("")},t.i=function(e,i,s,a,h){"string"==typeof e&&(e=[[null,e,void 0]]);var n={};if(s)for(var r=0;r<this.length;r++){var o=this[r][0];null!=o&&(n[o]=!0)}for(var m=0;m<e.length;m++){var g=[].concat(e[m]);s&&n[g[0]]||(void 0!==h&&(void 0===g[5]||(g[1]="@layer".concat(g[5].length>0?" ".concat(g[5]):""," {").concat(g[1],"}")),g[5]=h),i&&(g[2]?(g[1]="@media ".concat(g[2]," {").concat(g[1],"}"),g[2]=i):g[2]=i),a&&(g[4]?(g[1]="@supports (".concat(g[4],") {").concat(g[1],"}"),g[4]=a):g[4]="".concat(a)),t.push(g))}},t}},667:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},81:e=>{e.exports=function(e){return e[1]}},379:e=>{var t=[];function i(e){for(var i=-1,s=0;s<t.length;s++)if(t[s].identifier===e){i=s;break}return i}function s(e,s){for(var h={},n=[],r=0;r<e.length;r++){var o=e[r],m=s.base?o[0]+s.base:o[0],g=h[m]||0,l="".concat(m," ").concat(g);h[m]=g+1;var d=i(l),c={css:o[1],media:o[2],sourceMap:o[3],supports:o[4],layer:o[5]};if(-1!==d)t[d].references++,t[d].updater(c);else{var u=a(c,s);s.byIndex=r,t.splice(r,0,{identifier:l,updater:u,references:1})}n.push(l)}return n}function a(e,t){var i=t.domAPI(t);return i.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;i.update(e=t)}else i.remove()}}e.exports=function(e,a){var h=s(e=e||[],a=a||{});return function(e){e=e||[];for(var n=0;n<h.length;n++){var r=i(h[n]);t[r].references--}for(var o=s(e,a),m=0;m<h.length;m++){var g=i(h[m]);0===t[g].references&&(t[g].updater(),t.splice(g,1))}h=o}}},569:e=>{var t={};e.exports=function(e,i){var s=function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}(e);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(i)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,i)=>{e.exports=function(e){var t=i.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(i){!function(e,t,i){var s="";i.supports&&(s+="@supports (".concat(i.supports,") {")),i.media&&(s+="@media ".concat(i.media," {"));var a=void 0!==i.layer;a&&(s+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),s+=i.css,a&&(s+="}"),i.media&&(s+="}"),i.supports&&(s+="}");var h=i.sourceMap;h&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(h))))," */")),t.styleTagTransform(s,e,t.options)}(t,e,i)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},910:(e,t,i)=>{e.exports=i.p+"a3691dfe6b557fa4e7de.ttf"}},t={};function i(s){var a=t[s];if(void 0!==a)return a.exports;var h=t[s]={id:s,exports:{}};return e[s](h,h.exports,i),h.exports}i.m=e,i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var s=t.getElementsByTagName("script");if(s.length)for(var a=s.length-1;a>-1&&!e;)e=s[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),i.b=document.baseURI||self.location.href,i.nc=void 0,(()=>{var e=i(379),t=i.n(e),s=i(795),a=i.n(s),h=i(569),n=i.n(h),r=i(565),o=i.n(r),m=i(216),g=i.n(m),l=i(589),d=i.n(l),c=i(576),u={};u.styleTagTransform=d(),u.setAttributes=o(),u.insert=n().bind(null,"head"),u.domAPI=a(),u.insertStyleElement=g(),t()(c.Z,u),c.Z&&c.Z.locals&&c.Z.locals;class y{constructor(e,t,i){this.game=e,this.image=collisionAnimation,this.spriteWidth=100,this.spriteHeight=90,this.width=2.5*this.spriteWidth,this.height=2.5*this.spriteHeight,this.x=t,this.y=i,this.frameX=0,this.maxFrameX=4,this.fps=5,this.timeToNextFrame=1e3/this.fps,this.timer=0}draw(e){e.drawImage(this.image,this.frameX*this.spriteWidth,0,this.spriteWidth,this.spriteHeight,this.x,this.y,this.width,this.height)}update(e){this.timer>this.timeToNextFrame?(this.frameX<this.maxFrameX?this.frameX++:this.game.collisionAnimations.splice(this.game.collisionAnimations.indexOf(this),1),this.timer=0):this.timer+=e}}class p{constructor(e,t,i){this.game=e,this.x=t,this.y=i,this.sound=sound}checkCollisionEnemies(){this.game.enemies=this.game.enemies.filter((e=>e.x>this.x+this.dw||this.x>e.x+e.dw||e.y+e.dh<this.y||this.y+this.dh<e.y||("JanpanChicken"==e.value?this.game.collisionAnimations.unshift(new y(this.game,1.4*e.x,e.y)):this.game.collisionAnimations.unshift(new y(this.game,e.x,e.y)),this.sound.play(),this.game.score++,!1)))}checkCollisionPlayer(){if(this.game.player.x+.25*this.game.player.width>this.x+this.dw||this.x>this.game.player.x+.75*this.game.player.width||this.game.player.y+.9*this.game.player.height<this.y||this.y+this.dh<this.game.player.y+.1*this.game.player.height)return!0;this.game.player.lives--,this.game.player.lives<=0&&(this.game.over=!0)}draw(e){e.drawImage(this.image,this.sourceX,this.sourceY,this.imageW,this.imageH,this.x,this.y,this.dw,this.dh)}}class f extends p{constructor(e,t,i){super(e,t,i),this.image=bullet,this.sourceX=0,this.sourceY=100,this.imageW=500,this.imageH=100,this.dw=300,this.dh=60,this.speedX=4.5}update(e){this.x+=this.speedX*e}}class w extends p{constructor(e,t,i){super(e,t,i),this.image=bullet,this.sourceX=0,this.sourceY=0,this.imageW=500,this.imageH=100,this.dw=300,this.dh=60,this.speedX=4.5}update(e){this.x-=this.speedX*e}}const x={RunningRight:{frameX:0,frameY:0,maxFrameX:6,fps:8},RunningLeft:{frameX:0,frameY:1,maxFrameX:6,fps:8},StandingRight:{frameX:0,frameY:2,maxFrameX:5,fps:7},StandingLeft:{frameX:0,frameY:3,maxFrameX:5,fps:7},ShotingRight:{frameX:0,frameY:4,maxFrameX:5,fps:7},ShotingLeft:{frameX:0,frameY:5,maxFrameX:5,fps:7},JumpingRight:{frameX:0,frameY:6,maxFrameX:5,fps:7},JumpingLeft:{frameX:0,frameY:7,maxFrameX:5,fps:7}};class v{constructor(e){this.game=e}setFrame({frameX:e,frameY:t,maxFrameX:i,fps:s}){this.game.player.frameX=e,this.game.player.frameY=t,this.game.player.maxFrameX=i,this.game.player.refreshTime=1e3/s}toState(e){this.setFrame(e),e.value.startState?.(),this.game.player.currentState=e.value}addChangeWay(e,t,i){this.game.input.keys.includes(e)&&!this.game.input.keys.includes(t)&&this.toState(i)}checkShot(e){this.game.input.keys.includes("KeyJ")&&this.game.player.gunTimer>=300&&(gunSound.play(),"right"===e?this.game.player.shotThings.unshift(new f(this.game,this.game.player.x+.8*this.game.player.width,this.game.player.y+.6*this.game.player.height)):this.game.player.shotThings.unshift(new w(this.game,this.game.player.x-.8*this.game.player.width,this.game.player.y+.6*this.game.player.height)),this.game.player.shotThings.length=6,this.game.player.gunTimer=0)}initState(e){x.RunningLeft.value=new T(this.game),x.RunningRight.value=new S(this.game),x.StandingRight.value=new K(this.game),x.StandingLeft.value=new X(this.game),x.ShotingRight.value=new R(this.game),x.ShotingLeft.value=new W(this.game),x.JumpingRight.value=new C(this.game),x.JumpingLeft.value=new b(this.game),this.toState(e)}}class S extends v{constructor(e){super(e)}checkInput(){this.addChangeWay("KeyA","KeyD",x.RunningLeft),this.addChangeWay("KeyS","KeyD",x.StandingRight),this.addChangeWay("KeyW","KeyD",x.JumpingRight)}inState(e){this.game.player.x+=this.game.player.speedX*e}}class T extends v{constructor(e){super(e)}checkInput(){this.addChangeWay("KeyD","KeyA",x.RunningRight),this.addChangeWay("KeyS","KeyA",x.StandingLeft),this.addChangeWay("KeyW","KeyA",x.JumpingLeft)}inState(e){this.game.player.x-=this.game.player.speedX*e}}class K extends v{constructor(e){super(e)}checkInput(){this.addChangeWay("KeyD","KeyS",x.RunningRight),this.addChangeWay("KeyA","KeyS",x.RunningRight),this.addChangeWay("KeyJ","KeyS",x.ShotingRight),this.addChangeWay("KeyW","KeyS",x.JumpingRight)}inState(){}}class X extends v{constructor(e){super(e)}checkInput(){this.addChangeWay("KeyD","KeyS",x.RunningRight),this.addChangeWay("KeyA","KeyS",x.RunningRight),this.addChangeWay("KeyJ","KeyS",x.ShotingLeft),this.addChangeWay("KeyW","KeyS",x.JumpingLeft)}inState(){}}class R extends v{constructor(e){super(e)}checkInput(){this.addChangeWay("KeyD","KeyS",x.RunningRight),this.addChangeWay("KeyA","KeyS",x.RunningRight),this.addChangeWay("KeyW","KeyS",x.JumpingRight)}inState(){this.checkShot("right")}}class W extends v{constructor(e){super(e)}checkInput(){this.addChangeWay("KeyD","KeyS",x.RunningRight),this.addChangeWay("KeyA","KeyS",x.RunningRight),this.addChangeWay("KeyW","KeyS",x.JumpingLeft)}inState(){this.checkShot("left")}}class C extends v{constructor(e){super(e),this.game.player.speedY=0}checkInput(){this.addChangeWay("KeyD","KeyW",x.RunningRight),this.addChangeWay("KeyA","KeyW",x.RunningRight),this.addChangeWay("KeyS","KeyW",x.StandingRight)}startState(){this.game.player.onGround()&&(this.game.player.speedY=this.game.player.initSpeedY,this.game.player.y-=this.game.player.speedY)}inState(e){this.game.player.onGround()?(this.game.player.speedY=0,this.toState(x.RunningRight)):(this.game.player.speedY-=this.game.player.g*e,this.game.player.y-=this.game.player.speedY*e)}}class b extends v{constructor(e){super(e),this.game.player.speedY=0}checkInput(){this.addChangeWay("KeyD","KeyW",x.RunningLeft),this.addChangeWay("KeyA","KeyW",x.RunningLeft),this.addChangeWay("KeyS","KeyW",x.StandingLeft)}startState(){this.game.player.onGround()&&(this.game.player.speedY=this.game.player.initSpeedY,this.game.player.y-=this.game.player.speedY)}inState(e){this.game.player.onGround()?(this.game.player.speedY=0,this.toState(x.RunningLeft)):(this.game.player.speedY-=this.game.player.g*e,this.game.player.y-=this.game.player.speedY*e)}}class k{constructor(e){this.game=e,this.playerRunImage=playerRunImage,this.imageX=500,this.imageY=500,this.state=new v(this.game),this.currentState=x.RunningRight.value,this.height=300,this.width=300,this.gunTimer=500,this.lives=50,this.x=0,this.speedX=.5,this.y=this.game.height-this.height,this.initSpeedY=2.9,this.g=.0068,this.frameX=0,this.frameY=0,this.maxFrameX=6,this.timer=0,this.shotThings=[]}update(e){this.currentState.checkInput(),this.currentState.inState(e),this.checkGameEdge(),this.timer>this.refreshTime?(this.frameX<this.maxFrameX?this.frameX++:this.frameX=0,this.timer=0):this.timer+=e,this.game.player.gunTimer+=e}checkGameEdge(){this.x>this.game.width-this.width?this.x=this.game.width-this.width:this.x<0&&(this.x=0),this.y>this.game.height-this.height?this.y=this.game.height-this.height:this.y<0&&(this.y=0)}onGround(){if(this.y>=this.game.height-this.height)return!0}draw(e){e.drawImage(this.playerRunImage,this.imageX*this.frameX,this.imageY*this.frameY,this.imageX,this.imageY,this.x,this.y,this.width,this.height)}}class Y{constructor(e){this.game=e,this.keys=[],window.addEventListener("keydown",(e=>{if(!this.keys.includes(e.code))switch(e.code){case"KeyA":case"KeyS":case"KeyW":case"KeyD":case"KeyK":case"KeyJ":this.keys.push(e.code),console.log(this.keys,this.game.player.currentState)}})),window.addEventListener("keyup",(e=>{this.keys.includes(e.code)&&this.keys.splice(this.keys.indexOf(e.code),1),console.log(this.keys)}))}}class A{constructor(e){this.game=e}draw(e){e.drawImage(this.image,this.imageW*this.frameX,this.sourceY,this.imageW,this.imageH,this.x,this.y,this.dw,this.dh)}createEnemy(){if(this.game.enemies.length<5&&this.game.enemyTimers>=this.game.timeToNextEnemy){const e=Math.random();e<.5&&this.game.enemies.unshift(new F(this.game)),e<.8&&this.game.enemies.unshift(new E(this.game)),this.game.enemyTimers=0}}update(e){this.timer+=e,this.timer>this.refreshTime?(this.frameX<this.maxFrameX?this.frameX++:this.frameX=0,this.timer=0):this.timer+=e}}class F extends A{constructor(e){super(e),this.image=enemy,this.sourceX=0,this.sourceY=0,this.imageW=1e3,this.imageH=500,this.dw=600,this.dh=300,this.timer=0,this.maxFrameX=3,this.frameX=0,this.frameY=0,this.refreshTime=200,this.x=this.game.width*(1-.05*Math.random())-this.dw,this.y=(this.game.height-this.dh)*Math.random()*.8,this.value="JanpanChicken",this.gunTimer=300,this.shotThings=[],this.gunToHotTime=0,this.gunSound3=gunSound3}update(e){super.update(e),this.gunTimer+=e,this.gunToHotTime+=e,this.gunToHotTime>=1e3&&this.gunToHotTime<1900?this.gunTimer>=300&&(this.shotThings.unshift(new w(this.game,this.x-.12*this.dw,this.y+.27*this.dh)),this.gunSound3.play(),this.shotThings.length=2,this.gunTimer=0):this.gunToHotTime>3e3&&(this.gunToHotTime=0)}}class E extends A{constructor(e){super(e),this.image=enemy1,this.sourceX=0,this.sourceY=0,this.imageW=294,this.imageH=155,this.dw=210,this.dh=111,this.timer=0,this.maxFrameX=5,this.frameX=0,this.frameY=0,this.refreshTime=200,this.x=0,this.y=(this.game.height-this.dh)*(.2+.8*Math.random()),this.speedX=.1,this.vyAngle=0,this.va=.005*Math.random()+.01,this.value="FlyingEnemy"}update(e){super.update(e),this.x+=this.speedX*e,this.vyAngle+=this.va*e,this.y+=Math.sin(this.vyAngle)}checkCollisionPlayer(){if(this.game.player.x+.25*this.game.player.width>this.x+this.dw||this.x>this.game.player.x+.75*this.game.player.width||this.game.player.y+.9*this.game.player.height<this.y||this.y+this.dh<this.game.player.y+.1*this.game.player.height)return!0;this.game.player.lives-=5,this.game.enemies.splice(this.game.enemies.indexOf(this),1),sound.play(),this.game.collisionAnimations.unshift(new y(this.game,this.x,this.y)),this.game.player.lives<=0&&(this.game.over=!0)}}class I{constructor(e){this.game=e,this.fontSize=60,this.fontFamily="MaShanZheng",this.livesImage=lives}draw(e){e.save(),e.shadowOffsetX=3,e.shadowOffsetY=3,e.shadowColor="#a77346",e.shadowBlur=0,e.font=this.fontSize+"px "+this.fontFamily,e.textAlign="left",e.fillStyle="#fdf7f3",e.fillText("分数: "+this.game.score,20,50),e.shadowColor="white";for(let t=0;t<this.game.player.lives;t++)e.drawImage(this.livesImage,30*t+30,70,30,30);this.game.over&&(this.game.score>15?(e.shadowColor="yellow",e.fillStyle="red",e.textAlign="center",e.font=this.fontSize+"px "+this.fontFamily,e.fillText("犯我中华者虽远必诛!",.5*this.game.width,.5*this.game.height)):(e.fillStyle="black",e.shadowColor="white",e.textAlign="center",e.font=this.fontSize+"px "+this.fontFamily,e.fillText("革命尚未成功,同志仍需努力",.5*this.game.width,.5*this.game.height))),e.restore()}}window.addEventListener("load",(function(){const e=document.querySelector("#canvas1"),t=e.getContext("2d");e.width=1600,e.height=900;const i=new class{constructor(e,t){this.width=e,this.height=t,this.player=new k(this),this.input=new Y(this),this.enemy=new A(this),this.shotThing=new p(this),this.UI=new I(this),this.player.state.initState(x.RunningRight),this.enemies=[],this.collisionAnimations=[],this.timeToNextEnemy=1e3,this.enemyTimers=this.timeToNextEnemy,this.score=0,this.over=!1}update(e){this.player.update(e),this.player.shotThings.forEach((t=>{t?.update(e),t?.checkCollisionEnemies()})),this.enemyTimers+=e,this.enemy.createEnemy();for(let t=this.enemies.length-1;t>=0;t--)this.enemies[t].update(e),this.enemies[t].checkCollisionPlayer?.();this.enemies.forEach((t=>{t.shotThings?.forEach((t=>{t.update(e),t.checkCollisionPlayer()}))})),this.enemies=this.enemies.filter((e=>e.x<this.width)),this.collisionAnimations.forEach((t=>t.update(e)))}draw(e){this.player.draw(e),this.player.shotThings.forEach((t=>{t.draw(e)}));for(let t=this.enemies.length-1;t>=0;t--)this.enemies[t].draw(e);this.enemies.forEach((t=>{t.shotThings?.forEach((t=>{t.draw(e)}))})),this.collisionAnimations.forEach((t=>t.draw(e))),this.UI.draw(e)}}(e.width,e.height);let s=0;!function a(h){bgVideo.pause&&bgVideo.play();const n=h-s;s=h,t.clearRect(0,0,e.width,e.height),i.update(n),i.draw(t),i.over||requestAnimationFrame(a)}(0)}))})()})();